App As appinfo:
    BackEnabled: =false
    OnStart: |+
        =ClearCollect(
            colHorizontalMenu,
            {
                Title: "Executive",
                Screen: Blank(),
                Id: 1,
                ParentTab: ""
            },
            {
                Title: "KPI",
                Screen: Blank(),
                Id: 2,
                ParentTab: ""
            },
            {
                Title: "Overview",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "Safety",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "Quality",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "Performance",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "Cost",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "Shedule",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "People",
                Screen: Blank(),
                Id: 2,
                ParentTab: "KPI"
            },
            {
                Title: "Goals & Objective",
                Screen: Blank(),
                Id: 3,
                ParentTab: ""
            },
            {
                Title: "Overview",
                Screen: Blank(),
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Objective",
                Screen: Blank(),
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Issue",
                Screen: Blank(),
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Action",
                Screen: 'I4.0_DPMS_CSL_GnO_SC_IN-2',
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Insights",
                Screen: 'I4.0_DPMS_CSL_GnO_SC_IN-1',
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Create Objective",
                Screen: 'I4.0_DPMS_CSL_GnO_CO',
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Create Issue",
                Screen: 'I4.0_DPMS_CSL_GnO_CI',
                Id: 3,
                ParentTab: "Goals & Objective"
            },
            {
                Title: "Bi Monthly Report",
                Screen: Blank(),
                Id: 4,
                ParentTab: ""
            },
            {
                Title: "Configure",
                Screen: Blank(),
                Id: 5,
                ParentTab: ""
            },
            {
                Title: "Help",
                Screen: Blank(),
                Id: 6,
                ParentTab: ""
            }
        );
        Set(
            varMenuPrimaryColor,
            RGBA(
                58,
                55,
                46,
                100
            )
        );
        Set(
            varMenuSecondaryColor,
            RGBA(
                242,
                19,
                19,
                1
            )
        );
        Set(
            varTabSelected,
            0
        );
        //Global var for ORG & BU 
        Set(
            I4_0_DPMS_CSL_XXX_GVORG,
            "ORG1"
        );
        Set(
            I4_0_DPMS_CSL_XXX_GVBU,
            "BU1"
        );
        //Collecting the sharepoint user
        Set(
            I4_0_DPMS_CSL_XXX_GVSPU,
            'PowerApp->RequestType,GroupIs,Condition,SendanHTTPrequesttoS...'.Run(
                "User",
                "22",
                "1"
            ).respond
        );
        ClearCollect(
            I4_0_DPMS_CSL_XXX_CSPU,
            MatchAll(
                I4_0_DPMS_CSL_XXX_GVSPU,
                "(""Id"":(?<Id>[^""]*),""Title"":""(?<Title>[^""]*)"",""Email"":""(?<Email>[^""]*)"",""GroupId"":""(?<GroupId>[^""]*)"",""GroupName"":""(?<GroupName>[^""]*)"")"
            )
        );
        Set(
            I4_0_DPMS_CSL_XXX_GVSPU,
            'PowerApp->RequestType,GroupIs,Condition,SendanHTTPrequesttoS...'.Run(
                "User",
                "23",
                "2"
            ).respond
        );
        Collect(
            I4_0_DPMS_CSL_XXX_CSPU,
            MatchAll(
                I4_0_DPMS_CSL_XXX_GVSPU,
                "(""Id"":(?<Id>[^""]*),""Title"":""(?<Title>[^""]*)"",""Email"":""(?<Email>[^""]*)"",""GroupId"":""(?<GroupId>[^""]*)"",""GroupName"":""(?<GroupName>[^""]*)"")"
            )
        );
        Set(
            I4_0_DPMS_CSL_XXX_GVSPU,
            'PowerApp->RequestType,GroupIs,Condition,SendanHTTPrequesttoS...'.Run(
                "User",
                "24",
                "3"
            ).respond
        );
        Collect(
            I4_0_DPMS_CSL_XXX_CSPU,
            MatchAll(
                I4_0_DPMS_CSL_XXX_GVSPU,
                "(""Id"":(?<Id>[^""]*),""Title"":""(?<Title>[^""]*)"",""Email"":""(?<Email>[^""]*)"",""GroupId"":""(?<GroupId>[^""]*)"",""GroupName"":""(?<GroupName>[^""]*)"")"
            )
        );
        Set(
            I4_0_DPMS_CSL_XXX_GVSPU,
            'PowerApp->RequestType,GroupIs,Condition,SendanHTTPrequesttoS...'.Run(
                "User",
                "25",
                "4"
            ).respond
        );
        Collect(
            I4_0_DPMS_CSL_XXX_CSPU,
            MatchAll(
                I4_0_DPMS_CSL_XXX_GVSPU,
                "(""Id"":(?<Id>[^""]*),""Title"":""(?<Title>[^""]*)"",""Email"":""(?<Email>[^""]*)"",""GroupId"":""(?<GroupId>[^""]*)"",""GroupName"":""(?<GroupName>[^""]*)"")"
            )
        );
        Set(
            I4_0_DPMS_CSL_XXX_GVSPU,
            'PowerApp->RequestType,GroupIs,Condition,SendanHTTPrequesttoS...'.Run(
                "User",
                "26",
                "5"
            ).respond
        );
        Collect(
            I4_0_DPMS_CSL_XXX_CSPU,
            MatchAll(
                I4_0_DPMS_CSL_XXX_GVSPU,
                "(""Id"":(?<Id>[^""]*),""Title"":""(?<Title>[^""]*)"",""Email"":""(?<Email>[^""]*)"",""GroupId"":""(?<GroupId>[^""]*)"",""GroupName"":""(?<GroupName>[^""]*)"")"
            )
        );
        
        //Collection for sharepoint group
        ClearCollect(
            I4_0_DPMS_CSL_XXX_CSPG,
            Distinct(
                I4_0_DPMS_CSL_XXX_CSPU,
                GroupName
            )
        );
        //local variables for user group
        Set(
            I4_0_DPMS_CSL_XXX_GVUGN,
            Last(
                Filter(
                    I4_0_DPMS_CSL_XXX_CSPU,
                    Title = User().FullName
                ).GroupName
            ).GroupName 
        );
        
    StartScreen: =

